---
layout: post
title: CVE-2021-4102
date: 2022-01-07 14:46
summary: Analysis of CVE-2021-4102
meta_robots: noindex, nofollow
---

[https://chromereleases.googleblog.com/2021/12/stable-channel-update-for-desktop_13.html](https://chromereleases.googleblog.com/2021/12/stable-channel-update-for-desktop_13.html)

[$TBD][[1278387](https://crbug.com/1278387)] High CVE-2021-4102: Use after free in V8. Reported by Anonymous on 2021-12-09

Google is aware of reports that an exploit for CVE-2021-4102 exists __*in the wild*__.

[https://chromium.googlesource.com/v8/v8/+/4fae8b16802a416fe3aab0e7792fabe96cf1ecd8](https://chromium.googlesource.com/v8/v8/+/4fae8b16802a416fe3aab0e7792fabe96cf1ecd8)

```
[compiler] Don't elide ChangeTaggedToInt32->ChangeInt31ToTaggedSigned

Bug: chromium:1278387
```

author	Leszek Swirski <leszeks@chromium.org>	Fri Dec 10 14:56:05 2021

## 분석 전략

poc 없음, 분석 포스팅 없음, 정보가 전무함. 
패치도 딸랑 한 줄이 전부고 패치에 대한 커맨트도 없음.

내가 이것을 익스플로잇 할 수 있을지... 솔직히 자신 없음.

다만, 패치된 곳의 코드가 트리거되도록 하는 코드만이라도 짜보는 것이 목표.
그리고, 그 주변의 코드를 학습하고 그 내용을 잊지 않도록 정리해보자.


## 사전 작업

최신버전이 아닌, 구버전을 분석하는 작업이다 보니 cs chromium 을 이용하기 보다는, 직접 로컬에 코드를 두고 직접 빌드하고 vscode+clangd를 이용한 분석을 선호한다.

9.6 버전을 선택하였으며 [https://chromium.googlesource.com/v8/v8/+log/refs/heads/9.6-lkgr](https://chromium.googlesource.com/v8/v8/+log/refs/heads/9.6-lkgr)을 보고 9.6.180.20 버전을 선택.

clangd가 정상동작하지 않아서 삽질을 조금 하였음. 해결한 방법은 v8 빌드시 사용되는 clang 버전을 확인하고 이에 맞는 clangd를 받아서 설치하여 연동하도록 하였음. 자세한 내용은 슬랙 참고.

패치는 **simplified-operator-reducer.cc**에서 이루어졌으며 **simplified-operator-reducer-unittest.cc** 파일이 존재하는 것을 보고 unittest를 한 번 잠깐 살펴보았음.

![unittests](/images/2022-01-07_16:05:45.png)


test

> asdf
> asdf
> asdf
> 
> asdf

```cpp

// Hello!

int main() {
}

``` 


## test sharp

### test sharp


The following is an overview to copying and sharing Pixyll.[^1]

Most people have an understanding of what the copyright and licensing obligations are for source code, but not everyone has practical experience.  There is a lot of information about how to use free and open source source code generally, but not necessarily how it works specifically.

## Basics

Pixyll is free and open source software under the MIT license, a _permissive license_.  You can use Pixyll without charge and it is provided to you, "as is", without warranty of any kind.

These are some of the rights for Pixyll since it is under the MIT license:[^2]

1. You can **copy** Pixyll by forking it on GitHub or by any other means of copying.
2. You can **use** Pixyll to publish your site without restriction or limitation.
3. You can **change** Pixyll as you wish, and you can publish your site with a modified version of Pixyll.
4. You can also **distribute** copies of Pixyll to other people.
5. You can also **distribute modified** copies of Pixyll.

Other rights you have of Pixyll under the MIT license:

- You can **sell** copies of Pixyll, including copies you have modified.
- You can **combine** Pixyll with other works that are under the MIT license, or other permissive licenses, a copyleft license or a proprietary license.  Pixyll already does this itself by using Jekyll, Ruby and other dependencies.
- You can distribute copies of Pixyll to others under either the MIT license or you can **relicense** Pixyll under another license.  This includes a different permissive license, a copyleft license or a proprietary license.

Your only responsibility is to preserve both the copyright notices of Pixyll and the MIT license in your copy or modified work.

## How to

If you've modified Pixyll significantly and want to share your version, especially public copies of the code, then there are a few items you should do.

1. You should probably **rename** your fork of Pixyll with a different name.
2. A new name isn't required by the MIT license, but it is good etiquette.[^3]
3. You should add your name to the **copyright** of your version, and you should preserve the existing copyrights of Pixyll.
4. Maintaining the copyright notices isn't required of the MIT license, but it is suggested by the license and is a good practice for documenting the copyrights of your derived work.

The items above do not apply when you just copied and modified Pixyll in small ways to just publish your site and you have no plans to fork Pixyll under a different name.

If you want to publish a fork of Pixyll under a different name but keeping it under the MIT license, then you should add your name to the copyright notices:

    Copyright (c) 2021 Your Name
    Copyright (c) 2014-2021 John Otander for Pixyll

However, if you want to publish a fork of Pixyll under a different name *and* a different license, then you should should still add your name to the copyright notices but have a section titled "Pixyll" at the bottom of your LICENSE file that preserves the copyright and license notices for Pixyll:

    Pixyll
    
    Copyright (c) 2014-2021 John Otander
    
    MIT License
    
    Permission is hereby granted, [...]

If you are just modifying Pixyll in small ways to customize your site, you are not obligated to maintain the copyright notices of Pixyll on your site.  However, if you want to credit the Pixyll theme that would be appreciated, see section on "Pixyll Plug" in the README file that came with Pixyll.

Thanks for using Pixyll, and happy hacking!

---
[^1]: **Disclaimer**: This material is for informational purposes only, and should not be construed as legal advice or opinion.  For actual legal advice, you should consult with professional legal services.
[^2]: This list of privileges are derived from the four freedoms of "The Free Software Definition" published by the GNU project <https://www.gnu.org/philosophy/free-sw.en.html>.
[^3]: Using a different name from "Pixyll" for your derivate work helps avoid misdirected questions from people who are using your version.  It's similar to using version numbers to discrimate the revisions of software when troubleshooting issues.
